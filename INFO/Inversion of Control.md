---
created: 2025-02-04-13-31-49+10:00
tags:
---
**Inversion of Control (IoC)** ‚Äî —ç—Ç–æ –ø—Ä–∏–Ω—Ü–∏–ø –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏–µ–º –æ–±—ä–µ–∫—Ç–æ–≤, –∏—Ö –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –∏ —Å–≤—è–∑—è–º–∏ –º–µ–∂–¥—É –Ω–∏–º–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è **–≤–Ω–µ—à–Ω–µ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É** (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É), –∞ –Ω–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Å–∞–º–æ–≥–æ –∫–æ–¥–∞. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –±–æ–ª–µ–µ –≥–∏–±–∫–æ–π, –º–æ–¥—É–ª—å–Ω–æ–π –∏ –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–π.

### –ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:
–†–∞–Ω—å—à–µ –≤–∞—à –∫–æ–¥ —Å–∞–º —É–ø—Ä–∞–≤–ª—è–ª –≤—Å–µ–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ (¬´–Ø —Å–æ–∑–¥–∞—é –æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–Ω–µ –Ω—É–∂–Ω—ã¬ª). –° IoC –≤—ã –≥–æ–≤–æ—Ä–∏—Ç–µ: ¬´–ù–µ —è —Ä–µ—à–∞—é, –∫–∞–∫ –∏ –∫–æ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã ‚Äî —ç—Ç–∏–º –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∞ —è –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é –≥–æ—Ç–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏¬ª.

---

## –ü—Ä–∏–º–µ—Ä –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ üç≥
–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ:
- **–ë–µ–∑ IoC**: –í—ã —Å–∞–º–∏ –∏–¥–µ—Ç–µ –Ω–∞ –∫—É—Ö–Ω—é, –≥–æ—Ç–æ–≤–∏—Ç–µ –µ–¥—É, –º–æ–µ—Ç–µ –ø–æ—Å—É–¥—É.
- **–° IoC**: –í—ã –¥–µ–ª–∞–µ—Ç–µ –∑–∞–∫–∞–∑ –æ—Ñ–∏—Ü–∏–∞–Ω—Ç—É, –∞ —à–µ—Ñ-–ø–æ–≤–∞—Ä (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä) —Ä–µ—à–∞–µ—Ç, –∫–∞–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –±–ª—é–¥–æ, –∏ –ø—Ä–∏–Ω–æ—Å–∏—Ç –µ–≥–æ –≤–∞–º –≥–æ—Ç–æ–≤—ã–º.

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–¥–µ?
### –ë–µ–∑ IoC (–ñ–µ—Å—Ç–∫–∞—è —Å–≤—è–∑—å):
```csharp
public class ProductsController : ControllerBase
{
    public void GetProducts()
    {
        // –ü—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–∞
        var repository = new JsonProductRepository(); // –ñ–µ—Å—Ç–∫–∞—è –ø—Ä–∏–≤—è–∑–∫–∞
        var handler = new ProductHandler(repository); 
        // ... –ª–æ–≥–∏–∫–∞
    }
}
```
**–ü—Ä–æ–±–ª–µ–º–∞**: –ï—Å–ª–∏ –≤—ã –∑–∞—Ö–æ—Ç–∏—Ç–µ –∑–∞–º–µ–Ω–∏—Ç—å `JsonProductRepository` –Ω–∞ `SqlProductRepository`, –ø—Ä–∏–¥–µ—Ç—Å—è –º–µ–Ω—è—Ç—å –∫–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞.

---

### –° IoC (–ì–∏–±–∫–∞—è —Å–≤—è–∑—å):
```csharp
public class ProductsController : ControllerBase
{
    private readonly IProductHandler _handler;

    // –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–Ω–µ–¥—Ä—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
    public ProductsController(IProductHandler handler)
    {
        _handler = handler; // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–∞–º "–ø–æ–¥—Å—É–Ω–µ—Ç" –Ω—É–∂–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
    }

    public void GetProducts()
    {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
        var products = _handler.Get();
        // ... –ª–æ–≥–∏–∫–∞
    }
}
```
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Ω–µ –∑–Ω–∞–µ—Ç, –∫–∞–∫–∞—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `IProductHandler` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –ø–æ–¥–º–µ–Ω–∏—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Ç–µ—Å—Ç–æ–≤).

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ IoC:
1. **Dependency Injection (DI)**:
   - –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, –º–µ—Ç–æ–¥—ã –∏–ª–∏ —Å–≤–æ–π—Å—Ç–≤–∞.
   - –ü—Ä–∏–º–µ—Ä: `controller -> handler -> repository`.

2. **Service Locator**:
   - –û–±—ä–µ–∫—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ ¬´–ª–æ–∫–∞—Ç–æ—Ä–∞¬ª.
   ```csharp
   var handler = ServiceLocator.Resolve<IProductHandler>();
   ```

3. **–§–∞–±—Ä–∏–∫–∏**:
   - –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–±—Ä–∏—á–Ω—ã–µ –∫–ª–∞—Å—Å—ã.

---

## –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?
4. **–£–º–µ–Ω—å—à–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ (Coupling)**:
   - –ö–ª–∞—Å—Å—ã –Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π, —Ç–æ–ª—å–∫–æ –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤).

5. **–£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**:
   - –ú–æ–∂–Ω–æ –ø–æ–¥–º–µ–Ω—è—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ mock-–æ–±—ä–µ–∫—Ç–∞–º–∏.

6. **–ì–∏–±–∫–æ—Å—Ç—å**:
   - –ó–∞–º–µ–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å JSON –Ω–∞ SQL) —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

7. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
   - –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –æ–±—ä–µ–∫—Ç–æ–≤ (Singleton, Scoped, Transient) –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º.

---

## IoC-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ ASP.NET Core
–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `Program.cs`:
```csharp
builder.Services.AddScoped<IProductRepository, JsonProductRepository>();
builder.Services.AddScoped<IProductHandler, ProductHandler>();
```
–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.

---

## –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ IoC:
**¬´–ù–µ –∑–≤–æ–Ω–∏—Ç–µ –Ω–∞–º ‚Äî –º—ã –≤–∞–º –ø–æ–∑–≤–æ–Ω–∏–º¬ª**  
–û–±—ä–µ–∫—Ç—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç —Å–≤–æ–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–∞–º–∏, –∞ –ø–æ–ª—É—á–∞—é—Ç –∏—Ö –≥–æ—Ç–æ–≤—ã–º–∏ –æ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

---

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?
- –í –ø—Ä–æ–µ–∫—Ç–∞—Ö —Å —á–∞—Å—Ç–æ –º–µ–Ω—è—é—â–∏–º–∏—Å—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏.
- –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–∏—Å–∞—Ç—å –º–æ–¥—É–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã.

## –ß–µ–≥–æ –∏–∑–±–µ–≥–∞—Ç—å?
- –°–æ–∑–¥–∞–Ω–∏—è —Å–≤–æ–µ–≥–æ IoC-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –µ—Å–ª–∏ –µ—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ ASP.NET Core).
- –ò–∑–±—ã—Ç–æ—á–Ω–æ–≥–æ —É—Å–ª–æ–∂–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á.